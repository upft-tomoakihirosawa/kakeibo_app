# ユーザー登録画面 設計書

---

## 1. ドキュメント管理

- 文書名: ユーザー登録画面 設計書  
- 作成者: 廣澤  
- 作成日: 2025-05-16  

---

## 2. 画面概要

- 画面名称: ユーザー登録画面  
- 目的・概要:  
  ユーザーが初めてアプリを利用する際に、メールアドレスまたはSNSアカウントを用いて登録を行うための画面。ユーザーは必要事項（メールアドレス、パスワード、確認用パスワードなど）を入力し、登録ボタンを押下することでアカウントを作成できる。直感的かつシンプルなUIを心がけ、入力ミスへのフィードバックやエラーメッセージを適切に表示することで、登録プロセス全体のストレスを低減する。

---

## 3. UIコンポーネント詳細

### コンポーネント一覧

| コンポーネント名             | 属性           | 機能・動作                                                        | 導出元               | 導出元項目          | 備考                                              |
| ---------------------------- | -------------- | ------------------------------------------------------------------ | -------------------- | ------------------- | ------------------------------------------------- |
| ヘッダーラベル             | テキスト表示   | 「ユーザー登録」と画面タイトルを表示する                           | 固定文言             | -                   | 画面上部に常に表示                                |
| メールアドレス入力フィールド | テキスト入力   | ユーザーがメールアドレスを入力するためのフィールド                  | ユーザー入力         | email               | プレースホルダ「example@domain.com」              |
| パスワード入力フィールド     | パスワード入力 | ユーザーがパスワードを入力するためのフィールド                      | ユーザー入力         | password            | プレースホルダ「8文字以上の英数字」               |
| パスワード確認入力フィールド | パスワード入力 | ユーザーが再度同じパスワードを入力し、確認するためのフィールド         | ユーザー入力         | rePassword          | 入力値が前項と一致するかチェックする              |
| SNS連携ボタン（Google）      | ボタン         | クリックでGoogleアカウントによる登録フローを開始する                   | 外部API（Google）    | -                   | アイコン付き、連携用認証API呼び出し                |
| SNS連携ボタン（Facebook）    | ボタン         | クリックでFacebookアカウントによる登録フローを開始する                 | 外部API（Facebook）  | -                   | アイコン付き、連携用認証API呼び出し                |
| 登録送信ボタン               | ボタン         | 入力情報のバリデーション後、アカウント登録APIを呼び出し、登録処理を実行する | ユーザー登録API      | 登録情報一式        | 状態により活性/非活性が切り替わる                  |
| 戻るボタン                   | ボタン         | クリックで前画面（ログイン画面等）に戻る                              | 画面遷移ロジック     | -                   | ユーザー操作によるキャンセルとして機能           |
| 説明テキストラベル           | テキスト表示   | 各入力フィールドの下に、入力例や注意事項（例：「8文字以上の英数字」）を表示 | 固定文言             | -                   | 入力フィールド下部に小さめの文字サイズで表示       |
| ローディングインジケーター   | プログレスバー | API呼び出し中に画面上部または中央にローディング状態を示す               | API応答待ち          | -                   | 登録処理中、ユーザー操作をブロックする              |

---

## 4. 入力・出力項目

### 入力項目の詳細

画面表示時に呼び出し元から受け取るデータは特に無し

### 出力項目の詳細

画面終了時に呼び出し元に返すデータ項目は以下とする。

| 項目名       | 内容                                           |
| ------------ | ---------------------------------------------- |
| ユーザー情報 | 登録されたユーザーのID、メールアドレス等の情報   |
| メッセージ   | 登録成功もしくは失敗に関するフィードバックメッセージ |

---

## 5. イベント・アクション仕様

- 画面表示開始時の初期処理  
  ・各入力フィールドを空状態に初期化する  
  ・SNS連携ボタンや登録送信ボタンの活性状態を確認し、無効状態の解除を行う  

- 入力フィールドのフォーカスイベント  
  ・ユーザーがフォーカスした際、説明テキストラベルを強調表示する  

- 登録送信ボタン押下時の処理  
  1. 入力値に対してリアルタイムバリデーションを実行  
     - メール形式のチェック  
     - パスワード・パスワード確認の一致チェックと文字数/形式チェック  
  2. バリデーション成功後、ローディングインジケーターを表示し、ユーザー登録APIを呼び出す  
  3. API応答により以下の処理を実施  
     - 登録成功時：出力項目にユーザー情報と成功メッセージを設定し、次画面（ホーム画面等）へ遷移  
     - 登録失敗時：エラーメッセージを画面上に表示し、入力フィールドの状態を維持する  
  4. ローディングインジケーターを非表示にする

- SNS連携ボタン押下時の処理  
  ・対応するSNS認証APIを呼び出し、認証成功後に必要情報（メールアドレス等）を自動入力する  
  ・認証失敗時はエラーメッセージを表示する

- 戻るボタン押下時の処理  
  ・ユーザー確認用のポップアップ（「入力内容は破棄されますがよろしいですか？」）を表示し、確認後に前画面へ遷移する

- 画面終了時の終了処理  
  ・入力された情報のキャッシュをクリアし、必要に応じて完了結果（成功/失敗）がコール元に渡される

---

## 6. バリデーションとエラーハンドリング

### バリデーションルール

| 項目名             | 制約条件                                        | チェック方法                             | 備考                                       |
| ------------------ | ----------------------------------------------- | ---------------------------------------- | ------------------------------------------ |
| メールアドレス     | 必須、有効なメールフォーマット                  | 正規表現チェック（例：user@domain.com）   | RFC準拠のメールパターンを使用する           |
| パスワード         | 必須、8文字以上、英数字混合                       | 文字数チェック＋正規表現チェック         | 強度を考慮し、シンプルな英数字混合とする      |
| パスワード確認     | 必須、パスワード入力と一致                      | 入力値同士の一致チェック                  | 入力ミス防止のため再入力を促す               |

### エラーハンドリング

| エラーコード | エラーメッセージ                                          | 対処方法                                    |
| ------------ | --------------------------------------------------------- | ------------------------------------------- |
| ERR101       | メールアドレスは必須項目です。有効なメールアドレスを入力してください | ユーザーに入力内容の修正を促す              |
| ERR102       | パスワードは8文字以上の英数字混合で入力してください           | ユーザーに正しい形式での再入力を促す         |
| ERR103       | パスワード確認が一致しません                              | パスワードとパスワード確認の入力内容を再確認させる |
| ERR201       | 登録処理中にエラーが発生しました。再度お試しください           | API呼び出し失敗時、再試行や問い合わせを促す  |

---

## 7. 補足情報

- 外部連携・API:  
  ・ユーザー登録API: Firebase Auth または Node.js + MongoDB を利用し、ユーザー情報の登録処理を実施  
  ・SNS連携API: Google OAuthおよびFacebook OAuthを利用  
  ・各APIのエンドポイント、認証方式、サンプルリクエスト・レスポンスについては別途API仕様書を参照  

- 参考資料・用語集:  
  ・アプリ共通のデザインガイドライン  
  ・Firebase Auth/Web API リファレンス  
  ・OAuth関連資料

---

## 8. 課題、検討、不明事項

- SNS連携における各プロバイダの認証フローの詳細設計（エラーハンドリング、リダイレクトURLなど）については検討が必要  
- ユーザー登録後の初回ログイン時のデータ初期化処理（例：初期カテゴリ設定やウェルカムメッセージの自動生成）の仕様が未定  
- モバイル端末とWeb画面でのレスポンシブデザイン要件を満たすため、各UIコンポーネントのサイズ・レイアウト調整に関する詳細設計が今後必要  
- エラーメッセージの多言語対応（現状は日本語のみ）の対応範囲の検討  

---

## 9. 変更履歴

| 日付       | 変更内容                  | 担当者 |
| ---------- | ------------------------- | ------ |
| 2025-05-16 | 初版リリース              | 廣澤  |