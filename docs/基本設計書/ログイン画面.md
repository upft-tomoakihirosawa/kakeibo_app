# ログイン画面 設計書

---

## 1. ドキュメント管理

- 文書名: ログイン画面 設計書  
- 作成者: 廣澤  
- 作成日: 2025-05-16  

---

## 2. 画面概要

- 画面名称: ログイン画面  
- 目的・概要:  
  本画面は、家計簿アプリへのユーザー認証を目的とする。ユーザーは、メールアドレスとパスワードもしくはSNSアカウント（Google、Apple、Facebook等）を利用してログインを実施する。ログイン成功後、ユーザーはホーム画面（収支サマリーやグラフ表示）へ遷移し、アプリの各機能を利用できるようになる。また、パスワードリセット機能へのリンクや新規ユーザー登録画面への遷移ボタンも配置し、ユーザーが容易に利用開始できるようにする。

---

## 3. UIコンポーネント詳細

### コンポーネント一覧

| コンポーネント名         | 属性           | 機能・動作                                                         | 導出元                | 導出元項目         | 備考                                           |
| ------------------------ | -------------- | ------------------------------------------------------------------ | --------------------- | ------------------ | ---------------------------------------------- |
| アプリロゴ               | イメージ       | 画面上部にアプリのロゴを表示し、ブランディングを行う                | 特に無し            | 特に無し           | タッチ時のアクションは無し                     |
| メールアドレス入力フィールド | テキスト入力   | ユーザーがメールアドレスを入力するためのフィールド                   | ユーザーデータ入力API（暫定）  | メールアドレス       | プレースホルダ: "メールアドレスを入力"           |
| パスワード入力フィールド  | パスワード入力 | ユーザーがパスワードを入力するためのフィールド                       | ユーザーデータ入力API（暫定）  | パスワード         | プレースホルダ: "パスワードを入力"、マスク表示    |
| ログイン送信ボタン       | ボタン         | 入力されたメールアドレスとパスワードを元に認証処理を開始する            | 認証API（Firebase Auth等） | 特に無し           | クリック時、バリデーション実施後にAPI呼出し      |
| パスワードリセットリンク | テキストリンク | パスワードを忘れたユーザー向けに、パスワードリセット画面へ遷移する       | 特に無し            | 特に無し           | タップでリセット画面へ遷移                       |
| SNSログインボタン群      | ボタン         | 各SNS（Google、Apple、Facebook等）によるログインを実施するためのボタン群 | 認証API（OAuth連携）   | 特に無し           | 各ボタンに対象SNSのロゴを表示                   |
| 登録画面遷移ボタン       | ボタン         | 新規ユーザー登録画面へ遷移するためのボタン                             | 特に無し            | 特に無し           | 「新規登録はこちら」等の文言                     |
| 読込中インジケーター      | プログレスバー | 認証API呼出中に処理中であることを示すインジケーター                     | 認証API                | 特に無し           | 認証処理中のみ表示                              |

---

## 4. 入力・出力項目

### 入力項目の詳細

本画面表示時に呼び出し元から受け取るデータは「特に無し」。

### 出力項目の詳細

本画面終了時に呼び出し元へ返すデータは以下の通り。

| 項目名        | 内容                                             |
| ------------- | ------------------------------------------------ |
| 認証結果      | 成功または失敗のステータス、エラーメッセージ（失敗時） |
| ユーザー情報    | 認証成功時、ユーザーの基本情報（ユーザーID、メールアドレス等） |

---

## 5. イベント・アクション仕様

- 画面表示開始時:
  - 初期化処理として前回までのログイン情報のキャッシュ確認（必要に応じて自動ログイン処理）を実施。
  - 各入力フィールド、ボタンの初期状態（入力値クリア、インジケーター非表示）を設定。
  
- 画面上のアクションイベント:
  - メールアドレス入力フィールド: 入力内容の逐次チェック（フォーカスアウト時にフォーマットチェック）。
  - パスワード入力フィールド: 入力時にマスク表示、入力完了時にバリデーションチェック。
  - ログイン送信ボタン:
    - クリック時に、メールアドレスおよびパスワードの各入力項目のバリデーションを実施。
    - バリデーション成功の場合、読込中インジケーターを表示し認証APIへリクエスト送信。
    - 認証APIの応答に基づき、認証結果（成功：ホーム画面へ遷移 / 失敗：エラーメッセージの表示）を処理。
  - SNSログインボタン:
    - 各SNSの認証APIと連携し、認証処理を開始。完了後、認証結果に従い画面遷移処理を実施。
  - パスワードリセットリンク:
    - タップ時、パスワードリセット画面へ遷移。
  - 登録画面遷移ボタン:
    - タップ時、新規ユーザー登録画面へ遷移。
  
- 画面終了時:
  - 入力された情報をクリアする。
  - ログイン認証が成功した場合、認証結果および関連ユーザー情報を返却する。
  - 画面遷移直前に、必要に応じてセッション情報を更新。

---

## 6. バリデーションとエラーハンドリング

### バリデーションルール

| 項目名             | 制約条件                                   | チェック方法                        | 備考                                 |
| ------------------ | ------------------------------------------ | ----------------------------------- | ------------------------------------ |
| メールアドレス       | 必須、正しいメールアドレスのフォーマット       | リアルタイムフォーマットチェック、正規表現 | 例："user@example.com"                |
| パスワード         | 必須、8文字以上、英数字混合                   | 入力完了時に文字数および正規表現チェック      | 英数字混合かつ特殊文字推奨（セキュリティ強化の場合は） |

### エラーハンドリング

| エラーコード | エラーメッセージ                                      | 対処方法                                               |
| ------------ | ----------------------------------------------------- | ------------------------------------------------------ |
| ERR001       | メールアドレスを正しい形式で入力してください         | ユーザーにフォーマットエラーとしてフィールド横に表示    |
| ERR002       | パスワードは8文字以上の英数字を含む必要があります       | ユーザーにエラーメッセージを表示、再入力を促す             |
| ERR003       | 認証に失敗しました。メールアドレスまたはパスワードが誤っています | 認証APIからのエラーレスポンスを受け、画面上に通知         |
| ERR004       | ネットワークエラーが発生しました                       | ユーザーにネットワークエラーの旨を通知、再度試すよう促す     |

---

## 7. 補足情報

- 外部連携・API:
  - 認証API: Firebase AuthまたはOAuth認証サービスを利用する。エンドポイントは各サービスの提供するURLに準ずる。  
    例: Firebase Auth REST API  
  - SNS認証: Google、AppleおよびFacebookのOAuth認証API連携を実施する。
  
- 参考資料・用語集:
  - 家計簿アプリ要件定義書（2025/05）
  - Firebase Authドキュメント、OAuth認証ガイドライン
  - UI/UXデザインガイドライン（シンプルで直感的なUI設計）

---

## 8. 課題、検討、不明事項

- SNSログインにおける各SNSプラットフォームの認証フロー詳細（各SNSのSDK採用の可否および連携方法の検討が必要）。  
- 認証処理におけるエラーハンドリングの統一仕様（各種エラーコードの標準化）の検討。  
- ユーザーのログイン状態を保持するセッション管理方法（自動ログイン機能の実装方法）の検討。  
- UIのレスポンシブ対応における各デバイス（iOS、Android、Web）での表示最適化の検証が必要。

---

## 9. 変更履歴

| 日付       | 変更内容                             | 担当者 |
| ---------- | ------------------------------------ | ------ |
| 2025-05-16 | 初版リリース                         | 廣澤 |

